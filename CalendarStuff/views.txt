CREATE VIEW INTERNAL (VER, I_AVG_TURNOVER)
AS
SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 10 AS "AVG INTERNAL TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'INTERNAL'
GROUP BY VT.VER_NAME;


CREATE VIEW DEV (VER, D_AVG_TURNOVER)
AS
SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 15 AS "AVG DEV TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'DEVELOPMENT TEAM'
GROUP BY VT.VER_NAME;


CREATE VIEW VEN (VER, V_AVG_TURNOVER)
AS
SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 25 AS "AVG VENDOR TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'VENDOR'
GROUP BY VT.VER_NAME;
