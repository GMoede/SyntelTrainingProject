=====TRAININGS FOR A GIVEN SPOC NAME=====GRAPH 1====

-----Pie Chart------

//Number of Trainings Requested, for a given SPOC Name
//With month provided

SELECT TS.TS_DESC, COUNT(TRF.TRF_ID)
FROM TRAINING_REQUEST_FORM TRF
JOIN VERTICAL_TYPE VT
ON TRF.VER_ID = VT.VER_ID
JOIN LD_TEAM LT
ON VT.VER_ID = LT.LD_VER_REP
JOIN TRAINING_SOURCE TS
ON TRF.TS_TRAINING_SOURCE = TS.TS_ID
WHERE LT.LD_USER_NAME = 'CLINTON EXODIA'
AND EXTRACT( MONTH FROM TRF.TRF_DATE_REQUESTED ) IN (10)
GROUP BY TS.TS_DESC;

---Bar Graphs----

//Requested, In progress, and completed trainings for given SPOC Name


====TOTAL CONFIRMED TRAININGS===GRAPH 2=====

-----Pie Chart-----

//Total completed trainings, for all verticals, grouped by vertical
//With month provided

SELECT VT.VER_NAME, COUNT(CT.TRF_ID)
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE CT.CT_PROPOSED_END_DATE < sysdate
AND EXTRACT(MONTH FROM CT.CT_PROPOSED_END_DATE) IN (10)
GROUP BY VT.VER_NAME;

-----Bar Graph------

//Total completed trainings for a given vertical, grouped by I/D/V

SELECT TS.TS_DESC, COUNT(CT.TRF_ID)
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE VT.VER_NAME = 'MANUFACTURING'
GROUP BY TS.TS_DESC;

'BANKING AND FINANCIAL SERVICES'
'HEALTHCARE AND LIFESCIENCES'
'INSURANCE'
'RETAIL AND LOGISTICS'
'TELECOM, MEDIA, AND TECHNOLOGY'
'MANUFACTURING'



======TURNAROUND TIME GRAPH=======

//For all verticals, find average turnaround time (grouped by vertical name)

SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED))
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE EXTRACT (MONTH FROM CT.CT_PROPOSED_START_DATE) IN (10)
GROUP BY VT.VER_NAME;

//For given vertical name, find avg turnaround time for dev, vendor, internal 

SELECT TS.TS_DESC, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED))
FROM CONFIRMED_TRAINING CT
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE VT.VER_NAME = 'MANUFACTURING'
AND EXTRACT ( MONTH FROM CT.CT_PROPOSED_START_DATE ) IN (10)
GROUP BY TS.TS_DESC;

'BANKING AND FINANCIAL SERVICES'
'HEALTHCARE AND LIFESCIENCES'
'INSURANCE'
'RETAIL AND LOGISTICS'
'TELECOM, MEDIA, AND TECHNOLOGY'
'MANUFACTURING'

SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 10 AS "AVG INTERNAL TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'INTERNAL'
GROUP BY VT.VER_NAME;

SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 15 AS "AVG INTERNAL TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'DEVELOPMENT TEAM'
GROUP BY VT.VER_NAME;

SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED)) - 25 AS "AVG INTERNAL TURNOVER"
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
WHERE TS.TS_DESC = 'VENDOR'
GROUP BY VT.VER_NAME;

select * from training_source;

=====TOTAL ASSOCIATES TRAINED========

//For all verticals, find approx num of employees trained (grouped by vertical name)
//With month provided

SELECT VT.VER_NAME, SUM(CT.CT_APPROX_NO_EMPLOYEES)
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE EXTRACT ( MONTH FROM CT.CT_PROPOSED_END_DATE ) IN (10)
GROUP BY VT.VER_NAME;


