======TURNAROUND TIME GRAPH=======

//For all verticals, find average turnaround time (grouped by vertical name)

SELECT VT.VER_NAME, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED))
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
GROUP BY VT.VER_NAME;

//For given vertical name, find avg turnaround time for dev, vendor, internal 

SELECT TS.TS_DESC, trunc(avg(CT.CT_PROPOSED_START_DATE - CT.CT_DATE_REQUESTED))
FROM CONFIRMED_TRAINING CT
JOIN TRAINING_SOURCE TS
ON CT.CT_TRAINING_SOURCE = TS.TS_ID
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE VT.VER_NAME = 'MANUFACTURING'
GROUP BY TS.TS_DESC;

'BANKING AND FINANCIAL SERVICES'
'HEALTHCARE AND LIFESCIENCES'
'INSURANCE'
'RETAIL AND LOGISTICS'
'TELECOM, MEDIA, AND TECHNOLOGY'
'MANUFACTURING'

=====TOTAL ASSOCIATES TRAINED========

//For all verticals, find approx num of employees trained (grouped by vertical name)
//With month provided


SELECT VT.VER_NAME, SUM(CT.CT_APPROX_NO_EMPLOYEES)
FROM CONFIRMED_TRAINING CT
JOIN VERTICAL_TYPE VT
ON CT.VER_ID = VT.VER_ID
WHERE EXTRACT ( MONTH FROM CT.CT_PROPOSED_END_DATE ) IN (10)
GROUP BY VT.VER_NAME;

=====TRAININGS FOR A GIVEN SPOC NAME=========

//Number of Trainings Requested, for a given SPOC Name
//With month provided

SELECT COUNT(TRF.TRF_ID)
FROM TRAINING_REQUEST_FORM TRF
JOIN VERTICAL_TYPE VT
ON TRF.VER_ID = VT.VER_ID
JOIN LD_TEAM LT
ON VT.VER_ID = LT.LD_VER_REP
WHERE LT.LD_USER_NAME = 'CLINTON EXODIA'
AND EXTRACT( MONTH FROM TRF.TRF_DATE_REQUESTED ) IN (10);

